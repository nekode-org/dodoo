import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as p}from"./index.BJfUAbRs.js";import{s}from"./index.95d291e9.F47FPULG.js";const N=({folio:t,onInputChange:n})=>e.jsxs("div",{className:s.Elemento,children:[e.jsx("input",{type:"text",name:"ticketCode",placeholder:"Folio de ticket",className:s.Folio,value:t.ticketCode,onChange:i=>n(t.id,"ticketCode",i.target.value)}),e.jsxs("select",{name:"providerCode",className:s.Empresa,value:t.providerCode||"",onChange:i=>n(t.id,"providerCode",parseInt(i.target.value,10)),children:[e.jsx("option",{value:"",disabled:!0,children:"Selecciona una empresa"}),e.jsx("option",{value:"1",children:"Empresa 1"}),e.jsx("option",{value:"2",children:"Empresa 2"}),e.jsx("option",{value:"3",children:"Empresa 3"})]})]}),E=()=>{const[t,n]=p.useState({email:"",rfc:"",rfcPdf:null,rfcPdfName:null,tickets:[{id:Date.now(),ticketCode:"",providerCode:null}]}),[i,l]=p.useState(!1),[k,c]=p.useState(0),h=()=>{n({...t,tickets:[...t.tickets,{id:Date.now(),ticketCode:"",providerCode:null}]})},f=a=>{n({...t,tickets:t.tickets.filter(r=>r.id!==a)})},v=(a,r,o)=>{n({...t,tickets:t.tickets.map(d=>d.id===a?{...d,[r]:o}:d)})},u=a=>{const{name:r,value:o}=a.target;n({...t,[r]:o})},m=a=>{if(a){const r=new FileReader;r.onload=()=>{n({...t,rfcPdf:r.result.split(",")[1],rfcPdfName:a.name})},r.readAsDataURL(a)}else n({...t,rfcPdf:null,rfcPdfName:null})},g=a=>{a.preventDefault(),a.stopPropagation(),l(!1),c(0);const r=a.dataTransfer.files[0];r&&r.type==="application/pdf"?m(r):alert("Por favor, arrastra un archivo PDF vÃ¡lido.")},x=a=>{a.preventDefault(),a.stopPropagation()},j=a=>{a.preventDefault(),a.stopPropagation(),c(r=>r+1),l(!0)},C=a=>{a.preventDefault(),a.stopPropagation(),c(r=>{const o=r-1;return o===0&&l(!1),o})},D=async()=>{const a={...t,tickets:t.tickets.map(({id:r,...o})=>o)};console.log("Datos del formulario:",JSON.stringify(a));try{const r=await fetch("/providers/getInfo",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!r.ok)throw new Error("Error en la respuesta del servidor");const o=await r.json();console.log("Respuesta del servidor:",o),document.cookie=await`data=${encodeURIComponent(JSON.stringify(o))}; path=/; max-age=3600`,window.location.href="/Datos"}catch(r){console.error("Error al enviar el formulario:",r),alert("Error al enviar el formulario. Por favor, intÃ©ntalo de nuevo.")}};return e.jsxs("div",{className:s.fullScreenDropZone,onDrop:g,onDragOver:x,onDragEnter:j,onDragLeave:C,children:[i&&e.jsx("div",{className:s.dragOverlay,children:e.jsx("p",{children:"Suelta el archivo aquÃ­"})}),e.jsxs("div",{className:s.principal,children:[e.jsxs("label",{className:s.email,children:["Ingresa tu correo electrÃ³nico:",e.jsx("input",{type:"email",name:"email",value:t.email,onChange:u})]}),e.jsxs("div",{className:s.rfcContainer,children:[e.jsxs("div",{className:s.rfcPDF,children:[e.jsxs("label",{children:["Carga tu informaciÃ³n fÃ­scal en PDF.",e.jsx("p",{style:{color:"gray"},children:"Arrastra y suelta el archivo aquÃ­ o selecciona uno"}),e.jsx("input",{type:"file",accept:"application/pdf",onChange:a=>m(a.target.files[0])})]}),t.rfcPdfName&&e.jsxs("p",{style:{color:"green"},children:["Archivo cargado: ",t.rfcPdfName]})]}),e.jsx("p",{children:"O"}),e.jsxs("label",{className:s.rfcText,children:["Ingresar tu RFC:",e.jsx("input",{type:"text",name:"rfc",value:t.rfc,onChange:u})]})]}),e.jsxs("div",{className:s.foliosContainer,children:[e.jsxs("div",{className:s.Titulos,children:[e.jsx("h3",{children:"Ingresa el nÃºmero de ticket"}),e.jsx("h3",{className:s.Titulito,children:"Selecciona la empresa correspondiente al ticket"})]}),t.tickets.map(a=>e.jsxs("div",{className:s.folioitem,children:[e.jsx(N,{folio:a,onInputChange:v}),e.jsx("button",{onClick:()=>f(a.id),className:s.Basura,children:"ðŸ—‘"})]},a.id))]}),e.jsxs("div",{className:s.botonera,children:[e.jsx("button",{onClick:h,children:"Agregar Folio"}),e.jsx("button",{onClick:D,children:"Enviar Formulario"})]})]})]})};export{E as default};
